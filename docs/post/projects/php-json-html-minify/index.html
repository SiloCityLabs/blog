<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>PHP JSON HTML Minify</title>
  <meta property="og:title" content="PHP JSON HTML Minify" />
  <meta name="twitter:title" content="PHP JSON HTML Minify" />
  <meta name="description" content="Both of these functions are designed to be used with ob_start() and process the output before its sent to the user. You can also include caching into this to reduce overhead for static pages. It takes …">
  <meta property="og:description" content="Both of these functions are designed to be used with ob_start() and process the output before its sent to the user. You can also include caching into this to reduce overhead for static pages. It takes …">
  <meta name="twitter:description" content="Both of these functions are designed to be used with ob_start() and process the output before its sent to the user. You can also include caching into this to reduce overhead for static pages. It takes …">
  <meta name="author" content="Silo City Labs LLC"/>
  <link href='https://silocitylabs.com/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://silocitylabs.com/logo/144x144.png" />
  <meta name="twitter:image" content="https://silocitylabs.com/logo/144x144.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@silocitylabs" />
  <meta name="twitter:creator" content="@silocitylabs" />
  <meta property="og:url" content="https://silocitylabs.com/post/projects/php-json-html-minify/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="SCL Blog" />
  
  <link rel="canonical" href="https://silocitylabs.com/post/projects/php-json-html-minify/" />
  <link rel="amphtml" type="text/html" href="https://silocitylabs.com/amp/post/projects/php-json-html-minify/">
  
  
  
  
  
  
  <link rel="stylesheet" href="https://silocitylabs.com/css/bundle.min.css" />
  
  <link rel="manifest" href="https://silocitylabs.com/manifest.webmanifest">
  <meta name="theme-color" content="#e7e7e7">
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-78226868-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://silocitylabs.com/">SCL Blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="https://silocitylabs.com/">Blog</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Categories</a>
              <div class="navlinks-children">
                
                  <a href="https://silocitylabs.com/categories/company/">Official</a>
                
                  <a href="https://silocitylabs.com/categories/projects/">Side Projects</a>
                
                  <a href="https://silocitylabs.com/categories/tech-deals/">Deals</a>
                
                  <a href="https://silocitylabs.com/tags">Tags</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="https://silocitylabs.com/page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Newsletter" href="https://silocitylabs.com/newsletter">Newsletter</a>
            </li>
          
        

        

        
          <li>
            <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch" style="outline: none;" onclick="setTimeout( function(){ document.getElementById('gsc-i-id1').focus(); }, 400);">
              <span class="hidden-sm hidden-md hidden-lg">Search</span> <span id="searchGlyph" class="icon icon-search"></span>
            </a>
          </li>
        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="SCL Blog" href="https://silocitylabs.com/">
              
            <img class="avatar-img" src="https://silocitylabs.com/logo/144x144.png" alt="SCL Blog" />
          </a>
        
      </div>
    </div>

  </div>
</nav>



  <div id="modalSearch" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Search SCL Blog</h4>
        </div>
        <div class="modal-body">
          <gcse:search></gcse:search>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>


    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              <h1>PHP JSON HTML Minify</h1>
                
                
                  <span class="post-meta">
  Posted on September 15, 2015
  
</span>


                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>Both of these functions are designed to be used with ob_start() and process the output before its sent to the user. You can also include caching into this to reduce overhead for static pages. It takes the output of the page and makes the content up to 50% smaller in size by removing unused comments and whitespace in code. <a href="https://downloads.techreanimate.com/auowdk">Download the file here</a> or look at the code below.</p>

<p>HTML minify function</p>

<pre><code class="language-php">&lt;?php

	/*
	 * Warning: do not call this in main includes, only in base of html pages
	 * Does not work with css, js, json. only html
	 * 
	 * Must be called like this ob_start(&quot;sanitize_page&quot;);
	 */

	function sanitize_page($buffer) {
		if(IS_DEV){
			return $buffer;
		}else{
			$search = array(
				'/\&gt;[^\S ]+/s', /*strip whitespaces after tags, except space */
				'/[^\S ]+\&lt;/s', /*strip whitespaces before tags, except space */
				'/(\s)+/s' /* shorten multiple whitespace sequences */
			);
			
			$replace = array('&gt;','&lt;','\\1');
			
			return preg_replace($search, $replace, $buffer);
		}
		
	}
</code></pre>

<p>Json Minify Function</p>

<pre><code class="language-php">&lt;?php

	/*
	 * Warning: do not call this in main includes, only in base of html pages
	 * Does not work with css, js, html. only json
	 * 
	 * Must be called like this ob_start(&quot;json_minify&quot;);
	 */
	
	function json_minify($json) {
		if(IS_DEV){
			$tokenizer = &quot;/\&quot;|(\/\*)|(\*\/)|(\/\/)|\n|\r/&quot;;
			$in_string = false;
			$in_multiline_comment = false;
			$in_singleline_comment = false;
			$tmp; $tmp2; $new_str = array(); $ns = 0; $from = 0; $lc; $rc; $lastIndex = 0;
		
			while (preg_match($tokenizer,$json,$tmp,PREG_OFFSET_CAPTURE,$lastIndex)) {
				$tmp = $tmp[0];
				$lastIndex = $tmp[1] + strlen($tmp[0]);
				$lc = substr($json,0,$lastIndex - strlen($tmp[0]));
				$rc = substr($json,$lastIndex);
				if (!$in_multiline_comment &amp;&amp; !$in_singleline_comment) {
					$tmp2 = substr($lc,$from);
					if (!$in_string) {
						$tmp2 = preg_replace(&quot;/(\n|\r|\s)*/&quot;,&quot;&quot;,$tmp2);
					}
					$new_str[] = $tmp2;
				}
				$from = $lastIndex;
		
				if ($tmp[0] == &quot;\&quot;&quot; &amp;&amp; !$in_multiline_comment &amp;&amp; !$in_singleline_comment) {
					preg_match(&quot;/(\\\\)*$/&quot;,$lc,$tmp2);
					if (!$in_string || !$tmp2 || (strlen($tmp2[0]) % 2) == 0) {	/* start of string with &quot;, or unescaped &quot; character found to end string */
						$in_string = !$in_string;
					}
					$from--; /* include &quot; character in next catch */
					$rc = substr($json,$from);
				}
				else if ($tmp[0] == &quot;/*&quot; &amp;&amp; !$in_string &amp;&amp; !$in_multiline_comment &amp;&amp; !$in_singleline_comment) {
					$in_multiline_comment = true;
				}
				else if ($tmp[0] == &quot;*/&quot; &amp;&amp; !$in_string &amp;&amp; $in_multiline_comment &amp;&amp; !$in_singleline_comment) {
					$in_multiline_comment = false;
				}
				else if ($tmp[0] == &quot;//&quot; &amp;&amp; !$in_string &amp;&amp; !$in_multiline_comment &amp;&amp; !$in_singleline_comment) {
					$in_singleline_comment = true;
				}
				else if (($tmp[0] == &quot;\n&quot; || $tmp[0] == &quot;\r&quot;) &amp;&amp; !$in_string &amp;&amp; !$in_multiline_comment &amp;&amp; $in_singleline_comment) {
					$in_singleline_comment = false;
				}
				else if (!$in_multiline_comment &amp;&amp; !$in_singleline_comment &amp;&amp; !(preg_match(&quot;/\n|\r|\s/&quot;,$tmp[0]))) {
					$new_str[] = $tmp[0];
				}
			}
			$new_str[] = $rc;
			return implode(&quot;&quot;,$new_str);
		}else{
			return $json;
		}
	}
?&gt;
</code></pre>
      </article>

      <div class="clearfix">
        <div class="pull-right">
          <a href="https://github.com/SiloCityLabs/blog/commits/master/content/post/projects/php-json-html-minify.md">History</a> | 
          <a href="https://github.com/SiloCityLabs/blog/edit/master/content/post/projects/php-json-html-minify.md">Make an edit</a>
        </div>
      </div>
      <br />

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://silocitylabs.com/post/projects/db-class-php/" data-toggle="tooltip" data-placement="top" title="PHP Mysqli DB Class">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://silocitylabs.com/post/projects/megatouchmods/" data-toggle="tooltip" data-placement="top" title="Megatouchmods.com">Next Post &rarr;</a>
            </li>
          
        </ul>
      

      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:team@silocitylabs.com" title="Email me">
                  <span class="icon-stack icon-lg">
                    <i class="icon icon-circle icon-stack-2x"></i>
                    <i class="icon icon-mail icon-stack-1x icon-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.facebook.com/SiloCityLabs" title="Facebook">
                  <span class="icon-stack icon-lg">
                    <i class="icon icon-circle icon-stack-2x"></i>
                    <i class="icon icon-facebook icon-stack-1x icon-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://gitlab.com/silo-city-labs-llc" title="GitLab">
                  <span class="icon-stack icon-lg">
                    <i class="icon icon-circle icon-stack-2x"></i>
                    <i class="icon icon-gitlab icon-stack-1x icon-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/SiloCityLabs/blog" title="GitHub">
                  <span class="icon-stack icon-lg">
                    <i class="icon icon-circle icon-stack-2x"></i>
                    <i class="icon icon-github icon-stack-1x icon-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/silocitylabs" title="Twitter">
                  <span class="icon-stack icon-lg">
                    <i class="icon icon-circle icon-stack-2x"></i>
                    <i class="icon icon-twitter icon-stack-1x icon-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/company/10586208" title="LinkedIn">
                  <span class="icon-stack icon-lg">
                    <i class="icon icon-circle icon-stack-2x"></i>
                    <i class="icon icon-linkedin icon-stack-1x icon-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.youtube.com/channel/UC9vgzat1SRdQ8NNsCQ6d7cA" title="Youtube">
                  <span class="icon-stack icon-lg">
                    <i class="icon icon-circle icon-stack-2x"></i>
                    <i class="icon icon-youtube-play icon-stack-1x icon-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://silocitylabs.com/newsletter" title="Newsletter">
                  <span class="icon-stack icon-lg">
                    <i class="icon icon-circle icon-stack-2x"></i>
                    <i class="icon icon-newspaper icon-stack-1x icon-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="https://silocitylabs.com/index.xml" title="RSS">
              <span class="icon-stack icon-lg">
                <i class="icon icon-circle icon-stack-2x"></i>
                <i class="icon icon-rss icon-stack-1x icon-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          Silo City Labs LLC
          &nbsp;&bull;&nbsp;
          2019

          
            &nbsp;&bull;&nbsp;
            <a href="https://silocitylabs.com/">SCL Blog</a>
          
          
          &nbsp;&bull;&nbsp;
          <a href="https://github.com/SiloCityLabs/blog/" title="Github">Last built on Oct 4, 2019 at 12:25am (EST)</a>
        </p>
        <p class="credits theme-by text-muted">
          
        </p>
      </div>
    </div>
  </div>
</footer>







<script src="https://silocitylabs.com/js/bundle.min.js"></script>

<script> hljs.initHighlightingOnLoad(); </script>


<script>
  (function() {
    var cx = '006156681959470562953:oxkwuulite0';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-6882852717412296",
          enable_page_level_ads: true
     });
</script>

  </body>
</html>

